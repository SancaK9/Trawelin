@page "/"
@using Trawelin.App.Infrastructure.Constants.Storage
@layout LoginLayout

<div class="container">
	<div class="screen">
		<div class="screen__content">
			<div class="login">
				<div class="login__field">
					<i class="login__icon fas fa-user"></i>
					<input @bind="@getTokenQuery.Email" type="text" class="login__input" placeholder="User name / Email">
				</div>
				<div class="login__field">
					<i class="login__icon fas fa-lock"></i>
					<input @bind="@getTokenQuery.Password"  type="password" class="login__input" placeholder="Password">
				</div>
				<label>@result</label>
				<button disabled=@IsTaskRunning @onclick="LoginCheck" class="button login__submit">
					<span class="button__text">Giris Yap</span>
					<i class="button__icon fas fa-chevron-right"></i>
				</button>
			</div>
			
		</div>
		<div class="screen__background">
			<span class="screen__background__shape screen__background__shape4"></span>
			<span class="screen__background__shape screen__background__shape3"></span>
			<span class="screen__background__shape screen__background__shape2"></span>
			<span class="screen__background__shape screen__background__shape1"></span>
		</div>
	</div>
</div>

@code{
	public GetTokenQuery getTokenQuery = new();



	bool IsTaskRunning = false;
	string result = "";

	protected override async Task OnInitializedAsync()
	{
		getTokenQuery.Email = "admin@trawelin.com";
		getTokenQuery.Password = "Admin12345.!*";
		LoginCheck();

	}

	public async void LoginCheck()
	{
			
		var result = await _authenticationManager.Login(getTokenQuery);
		if (result.Succeeded)
		{
			_navigationManager.NavigateTo("/Index", true);
		}
		
	}

}